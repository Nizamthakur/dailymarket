{% load static %}
<section class="category-area pt-25 pb-15" style="background:#fff;">
  <div class="container custom-container">
    <!-- Section Header -->
    <div class="row mb-3">
      <div class="col-12 d-flex justify-content-between align-items-center">
        <h5 style="font-size:1rem; font-weight:600; color:#333;">Categories</h5>
      </div>
    </div>

    <!-- Categories Horizontal Scroll -->
    <div class="category-scroll">
      {% for category in categories %}
      <div class="category-item">
        <a href="{% url 'all_products' %}?category={{ category.slug }}">
          <!-- Category Image -->
          <div class="category-image">
            {% if category.image %}
              <img src="{{ category.image.url }}" alt="{{ category.name }}">
            {% else %}
              <img src="{% static 'images/default-category.png' %}" alt="{{ category.name }}">
            {% endif %}
          </div>
          <!-- Category Name -->
          <p class="category-name">{{ category.name }}</p>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<style>
.category-scroll {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding-bottom: 5px;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE 10+ */
}

.category-scroll::-webkit-scrollbar {
  display: none; /* Chrome/Safari */
}

.category-item {
  flex: 0 0 auto;
  text-align: center;
  width: 80px; /* slightly increase width */
  word-wrap: break-word; /* wrap long text */
}

.category-image {
  width: 60px;
  height: 60px;
  margin: auto;
  overflow: hidden;
  border-radius: 50%;
  border: 1px solid #eee;
}

.category-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.category-name {
  font-size: 0.65rem; /* slightly smaller */
  margin-top: 0.25rem;
  white-space: normal; /* allow wrap */
  word-break: break-word; /* wrap long words */
}
</style>

<!-- Hide scrollbar in Chrome/Safari -->
<style>
  .category-area div[style*="overflow-x:auto"]::-webkit-scrollbar {
    display: none;
  }
</style>

<section class="trending-product-area light-bg-s pt-20 pb-10">
  <div class="container custom-conatiner">
    <!-- Section Header -->
    <div class="row">
      <div class="col-12">
        <div class="section__head d-flex justify-content-between mb-20">
          <div class="section__title section__title-2">
            <h5 class="st-titile fs-6">{{ trending_division_title }}</h5>
          </div>
          <div class="button-wrap button-wrap-2">
            <div class="button-wrap button-wrap-2">
                <a href="{% url 'all_products' %}" class="fs-7">
                    See All Product <i class="fal fa-chevron-right"></i>
                </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Trending Products Grid -->
    <div class="row g-2">
      {% for product in trending_product %}
      <div class="col-6 col-md-4 col-lg-2">
        <div class="product__item product__item-2 b-radius-2 h-100 d-flex flex-column">
          <!-- Product Image -->
          <div class="product__thumb fix position-relative">
            <div class="product-image w-img">
              <a href="{% url 'product_details' product.slug %}">
                <img src="{{ product.productimage_set.first.image.url }}" alt="{{ product.title }}" class="img-fluid">
              </a>
            </div>

            <!-- Discount Badge -->
            {% if product.discounted_parcent %}
            <div class="product__offer position-absolute top-0 start-0 m-1">
              <span class="discount fs-7">-{{ product.discounted_parcent }}%</span>
            </div>
            {% endif %}

            <!-- Product Actions -->
            <div class="product-action product-action-2 position-absolute bottom-2 end-2 d-flex flex-column gap-1">
              <a href="#" class="icon-box icon-box-sm d-flex align-items-center justify-content-center text-white bg-dark bg-opacity-75 rounded-circle p-1" data-bs-toggle="modal" data-bs-target="#productModalId" title="Quick View">
                <i class="fal fa-eye fs-6"></i>
              </a>
              <a href="#" class="icon-box icon-box-sm d-flex align-items-center justify-content-center text-white bg-dark bg-opacity-75 rounded-circle p-1" title="Add to Wishlist">
                <i class="fal fa-heart fs-6"></i>
              </a>
              <a href="#" class="icon-box icon-box-sm d-flex align-items-center justify-content-center text-white bg-dark bg-opacity-75 rounded-circle p-1" title="Compare">
                <i class="fal fa-layer-group fs-6"></i>
              </a>
            </div>

          </div>

          <!-- Product Info -->
          <div class="product__content product__content-2 mt-1 flex-grow-1 d-flex flex-column justify-content-between">
            <div>
              <h6 class="mb-1 fs-7">
                <a href="{% url 'product_details' product.slug %}">
                  {{ product.title|truncatewords:5 }}
                </a>
              </h6>
              <strong class="d-block mb-1 fs-7">
                {% if product.vendor_stores %}
                  <a href="{% url 'vendor_store_with_product' product.vendor_stores.id %}">
                    {{ product.vendor_stores.store_name }}
                  </a>
                {% else %}
                  <span>Daily market original</span>
                {% endif %}
              </strong>

              <!-- Rating -->
              <div class="rating mb-1">
                <ul class="list-inline mb-0">
                  {% for i in "12345" %}
                  <li class="list-inline-item fs-7"><i class="fal fa-star"></i></li>
                  {% endfor %}
                </ul>
                <span class="fs-7">({{ product.total_review_of_product.count }} review)</span>
              </div>

              <!-- Price -->
              <div class="price mb-1 fs-7">
                <p>à§³{{ product.discounted_price }}</p>
              </div>

              <!-- Stock -->
              <div class="progress mb-1" style="height: 5px;">
                <div class="progress-bar bg-danger" role="progressbar" style="width: 50%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
              <div class="progress-rate mb-1 fs-7">
                <span>Available Item: {{ product.stoc }}</span>
              </div>
            </div>

            <!-- Add to Cart -->
            <div class="product__add-cart text-center mt-1">
  {% if product.stoc != 0 %}
  <a href="{% url 'add_to_cart' product.id %}"
     class="cart-btn-3 d-flex align-items-center justify-content-center w-100 px-2 py-1 fs-7"
     style="font-size:0.75rem; padding:0.25rem 0.5rem;">
    Add to Cart
  </a>
  {% else %}
  <p class="cart-btn-3 d-flex align-items-center justify-content-center w-100 px-2 py-1 fs-7"
     style="font-size:0.75rem; padding:0.25rem 0.5rem;">
    Out of Stock
  </p>
  {% endif %}
</div>

          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
